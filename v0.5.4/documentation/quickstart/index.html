<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quickstart · Plasmo.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Plasmo.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Plasmo.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Quickstart</a><ul class="internal"><li><a class="tocitem" href="#Create-an-OptiGraph"><span>Create an OptiGraph</span></a></li><li><a class="tocitem" href="#Add-OptiNodes"><span>Add OptiNodes</span></a></li><li><a class="tocitem" href="#Create-LinkConstraints"><span>Create LinkConstraints</span></a></li><li><a class="tocitem" href="#Solve-the-OptiGraph-and-Query-the-Solution"><span>Solve the OptiGraph and Query the Solution</span></a></li><li><a class="tocitem" href="#Visualize-the-Structure"><span>Visualize the Structure</span></a></li></ul></li><li><a class="tocitem" href="../modeling/">Modeling with OptiGraphs</a></li><li><a class="tocitem" href="../partitioning/">Graph Partitioning and Processing</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/gas_pipeline/">Optimal Control of a Natural Gas Network</a></li></ul></li><li><a class="tocitem" href="../api_docs/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quickstart</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quickstart</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/plasmo-dev/Plasmo.jl/blob/master/docs/src/documentation/quickstart.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quickstart"><a class="docs-heading-anchor" href="#Quickstart">Quickstart</a><a id="Quickstart-1"></a><a class="docs-heading-anchor-permalink" href="#Quickstart" title="Permalink"></a></h1><p>This quickstart example gives a brief overview of the functions needed to effectively use Plasmo.jl to build optimization models. If you are familiar with <a href="https://github.com/jump-dev/JuMP.jl">JuMP.jl</a>, much of the functionality you see here will be familiar. In fact, the primary <a href="../api_docs/#Plasmo.OptiGraph"><code>OptiGraph</code></a> and <a href="../api_docs/#Plasmo.OptiNode"><code>OptiNode</code></a> objects from Plasmo.jl extend the <code>JuMP.AbstractModel</code> and support many JuMP functions.  </p><p>The below example demonstrates the construction of a simple linear optimization problem that contains two optinodes coupled by a simple <a href="../api_docs/#Plasmo.LinkConstraint"><code>LinkConstraint</code></a> (which creates an <a href="../api_docs/#Plasmo.OptiEdge"><code>OptiEdge</code></a>) which is solved with the <a href="https://github.com/jump-dev/GLPK.jl">GLPK</a> linear optimization solver. Additional examples can be found at the <a href="https://github.com/plasmo-dev/PlasmoExamples">Plasmo Examples</a> repository.</p><p>Once Plasmo.jl has been installed, you can use it from a Julia session as following:</p><pre><code class="language-julia-repl">julia&gt; using Plasmo</code></pre><p>For this example we also need to import the GLPK optimization solver and the <a href="https://github.com/plasmo-dev/PlasmoPlots.jl">PlasmoPlots</a> package which we use to visualize graph structure.</p><pre><code class="language-julia">julia&gt; using GLPK
julia&gt; using PlasmoPlots</code></pre><h2 id="Create-an-OptiGraph"><a class="docs-heading-anchor" href="#Create-an-OptiGraph">Create an OptiGraph</a><a id="Create-an-OptiGraph-1"></a><a class="docs-heading-anchor-permalink" href="#Create-an-OptiGraph" title="Permalink"></a></h2><p>The following command will create the optigraph (referred to as <code>graph</code>). We also see the printed output which denotes the number of optinodes, optiedges, link-constraints, and subgraphs (other optigraphs contained within <code>graph</code>).</p><pre><code class="language-julia-repl">julia&gt; graph = OptiGraph()
      OptiGraph: # elements (including subgraphs)
-------------------------------------------------------------------
      OptiNodes:     0              (0)
      OptiEdges:     0              (0)
LinkConstraints:     0              (0)
 sub-OptiGraphs:     0              (0)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>An <a href="../api_docs/#Plasmo.OptiGraph"><code>OptiGraph</code></a> distinguishes between its direct elements (optinodes and optiedges contained directly within the graph) and its subgraph elements (optinodes and optiedges contained within its subgraphs). This distinction is used to describe hierarchical graph structures in <a href="../modeling/#Hierarchical-Modeling-using-Subgraphs">Hierarchical Modeling using Subgraphs</a>.</p></div></div><h2 id="Add-OptiNodes"><a class="docs-heading-anchor" href="#Add-OptiNodes">Add OptiNodes</a><a id="Add-OptiNodes-1"></a><a class="docs-heading-anchor-permalink" href="#Add-OptiNodes" title="Permalink"></a></h2><p>An optigraph consists of <a href="../api_docs/#Plasmo.OptiNode"><code>OptiNode</code></a><code>s</code> which contain stand-alone optimization models. An optinode supports JuMP macros used to create variables, constraints, expressions, and objective functions (i.e. it supports JuMP macros such as <code>@variable</code>, <code>@constraint</code>, and <code>@objective</code>). The simplest way to add optinodes to an optigraph is to use the <a href="../api_docs/#Plasmo.@optinode"><code>@optinode</code></a> macro as shown in the following code snippet. For this example we create the optinode <code>n1</code>, we create two optinode variables <code>x</code> and <code>y</code>, and we add a single constraint and an objective function.</p><pre><code class="language-jldocest">julia&gt; @optinode(graph, n1)
OptiNode w/ 0 Variable(s) and 0 Constraint(s)

julia&gt; @variable(n1, y &gt;= 2)
n1[:y]

julia&gt; @variable(n1, x &gt;= 0)
n1[:x]

julia&gt; @constraint(n1, x + y &gt;= 3)
n1[:y] + n1[:x] ≥ 3.0

julia&gt; @objective(n1, Min, y)
n1[:y]</code></pre><p>We can create more optinodes and add variables, constraints, and objective functions to each of them.</p><pre><code class="language-julia">julia&gt; @optinode(graph, n2);
julia&gt; @variable(n2, y &gt;= 0);
julia&gt; @variable(n2, x &gt;= 0);
julia&gt; @constraint(n2, x + y &gt;= 3);
julia&gt; @objective(n2, Min, y);

julia&gt; @optinode(graph, n3);
julia&gt; @variable(n3, y &gt;= 0);
julia&gt; @variable(n3, x &gt;= 0);
julia&gt; @constraint(n3, x + y &gt;= 3);
julia&gt; @objective(n3, Min, y);  </code></pre><pre><code class="language-julia-repl">julia&gt; println(graph)
      OptiGraph: # elements (including subgraphs)
-------------------------------------------------------------------
      OptiNodes:     3              (3)
      OptiEdges:     0              (0)
LinkConstraints:     0              (0)
 sub-OptiGraphs:     0              (0)</code></pre><h2 id="Create-LinkConstraints"><a class="docs-heading-anchor" href="#Create-LinkConstraints">Create LinkConstraints</a><a id="Create-LinkConstraints-1"></a><a class="docs-heading-anchor-permalink" href="#Create-LinkConstraints" title="Permalink"></a></h2><p>A <a href="../api_docs/#Plasmo.LinkConstraint"><code>LinkConstraint</code></a> can be used to couple variables between optinodes. Creating a link-constraint automatically creates an <a href="../api_docs/#Plasmo.OptiEdge"><code>OptiEdge</code></a> in the optigraph which describes the connectivity between optinodes.  Link-constraints are created using the <a href="../api_docs/#Plasmo.@linkconstraint"><code>@linkconstraint</code></a> macro which takes the exact same input as the <code>JuMP.@constraint</code> macro. The following code creates a link-constraint between variables on the three optinodes.</p><pre><code class="language-julia-repl">julia&gt; @linkconstraint(graph, n1[:x] + n2[:x] + n3[:x] == 3)
: n1[:x] + n2[:x] + n3[:x] = 3.0

julia&gt; println(graph)
      OptiGraph: # elements (including subgraphs)
-------------------------------------------------------------------
      OptiNodes:     3              (3)
      OptiEdges:     1              (1)
LinkConstraints:     1              (1)
 sub-OptiGraphs:     0              (0)
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Using the standard <code>@constraint</code> macro on an optigraph will also create a link-constraint. The <code>@linkconstraint</code> syntax is preferred to help model readability.</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Nonlinear link-constraints are not yet supported.</p></div></div><h2 id="Solve-the-OptiGraph-and-Query-the-Solution"><a class="docs-heading-anchor" href="#Solve-the-OptiGraph-and-Query-the-Solution">Solve the OptiGraph and Query the Solution</a><a id="Solve-the-OptiGraph-and-Query-the-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-the-OptiGraph-and-Query-the-Solution" title="Permalink"></a></h2><p>When using a <a href="https://github.com/jump-dev/MathOptInterface.jl">MathOptInterface.jl</a> (MOI) optimization solver, we can optimize an optigraph using the <a href="../api_docs/#JuMP.set_optimizer"><code>set_optimizer</code></a> and <a href="../api_docs/#JuMP.optimize!"><code>optimize!</code></a> functions extended from JuMP.   Plasmo.jl will translate the optigraph into an MOI optimizer to solve the model.</p><pre><code class="language-julia-repl">julia&gt; set_optimizer(graph, GLPK.Optimizer)

julia&gt; optimize!(graph)</code></pre><p>After returning from the optimizer we can query the termination status using <a href="../api_docs/#JuMP.termination_status"><code>termination_status</code></a> (again just like in JuMP). We can also query the solution of variables using <a href="../api_docs/#JuMP.value"><code>value</code></a> and the objective value of the graph using <a href="../api_docs/#JuMP.objective_value"><code>objective_value</code></a></p><pre><code class="language-julia-repl">julia&gt; termination_status(graph)   
OPTIMAL::TerminationStatusCode = 1

julia&gt; value(n1[:x])    
1.0

julia&gt; value(n2[:x])
2.0

julia&gt; value(n3[:x])
0.0

julia&gt; objective_value(graph)
6.0</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is also possible to optimize individual optinodes, or even optimize different optigraphs that share the same optinode. The latest optimization result is always accessible using <code>value(variable)</code>. The results specific to an optinode or optigraph can be accessed with <code>value(node, variable)</code> (for optinodes) or <code>value(graph, variable)</code> (for optigraphs).</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Plasmo.jl assumes the objective function of each optinode is added by default.  The objective function for an optigraph can be changed using the <code>@objective</code> macro on the optigraph itself. This will update the local objective function on each optinode.</p><p>Nonlinear graph objective functions are not yet supported. Currently, the user must set nonlinear objective functions on each optinode which get added together.</p></div></div><h2 id="Visualize-the-Structure"><a class="docs-heading-anchor" href="#Visualize-the-Structure">Visualize the Structure</a><a id="Visualize-the-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Visualize-the-Structure" title="Permalink"></a></h2><p>Lastly, it is often useful to visualize the structure of an optigraph. The visualization can lead to insights about an optimization problem and understand its connectivity. Plasmo.jl uses <a href="https://github.com/plasmo-dev/PlasmoPlots.jl">PlasmoPlots.jl</a> (which builds on <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> and <a href="https://github.com/JuliaGraphs/NetworkLayout.jl">NetworkLayout.jl</a>) to visualize the layout of an optigraph. The code here shows how to obtain the graph topology using <a href="../api_docs/#PlasmoPlots.layout_plot"><code>PlasmoPlots.layout_plot</code></a> and we plot the corresponding incidence matrix structure using <a href="../api_docs/#PlasmoPlots.matrix_plot"><code>PlasmoPlots.matrix_plot</code></a>. Both of these functions can accept keyword arguments to customize their layout or appearance. The matrix visualization also encodes information on the number of variables and constraints in each optinode and optiedge. The left figure shows a standard graph visualization where we draw an edge between each pair of nodes if they share an edge, and the right figure shows the matrix representation where labeled blocks correspond to nodes and blue marks represent linking constraints that connect their variables. The node layout helps visualize the overall connectivity of the graph while the matrix layout helps visualize the size of nodes and edges.</p><pre><code class="language-julia">plt_graph = PlasmoPlots.layout_plot(graph,
            node_labels=true, markersize=30, labelsize=15, linewidth=4,
            layout_options=Dict(:tol=&gt;0.01, :iterations=&gt;2),
            plt_options=Dict(:legend=&gt;false, :framestyle=&gt;:box, :grid=&gt;false,
            :size=&gt;(400,400), :axis=&gt;nothing))

plt_matrix = PlasmoPlots.matrix_plot(graph, node_labels=true, markersize=15)   </code></pre><p><img src="../../assets/graph_layout.svg" alt="graph_quickstart"/> <img src="../../assets/matrix_layout.svg" alt="matrix_quickstart"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Introduction</a><a class="docs-footer-nextpage" href="../modeling/">Modeling with OptiGraphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 10 October 2023 05:11">Tuesday 10 October 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
