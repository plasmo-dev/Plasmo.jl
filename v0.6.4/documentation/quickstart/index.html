<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quickstart · Plasmo.jl</title><meta name="title" content="Quickstart · Plasmo.jl"/><meta property="og:title" content="Quickstart · Plasmo.jl"/><meta property="twitter:title" content="Quickstart · Plasmo.jl"/><meta name="description" content="Documentation for Plasmo.jl."/><meta property="og:description" content="Documentation for Plasmo.jl."/><meta property="twitter:description" content="Documentation for Plasmo.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Plasmo.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Plasmo.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Quickstart</a><ul class="internal"><li><a class="tocitem" href="#Create-an-OptiGraph"><span>Create an OptiGraph</span></a></li><li><a class="tocitem" href="#Add-Variables-and-Constraints-(using-OptiNodes)"><span>Add Variables and Constraints (using OptiNodes)</span></a></li><li><a class="tocitem" href="#Add-Linking-Constraints-(using-Edges)"><span>Add Linking Constraints (using Edges)</span></a></li><li><a class="tocitem" href="#Solve-the-OptiGraph-and-Query-the-Solution"><span>Solve the OptiGraph and Query the Solution</span></a></li><li><a class="tocitem" href="#Visualize-the-Structure"><span>Visualize the Structure</span></a></li></ul></li><li><a class="tocitem" href="../modeling/">Modeling with OptiGraphs</a></li><li><a class="tocitem" href="../graph_processing/">Graph Processing and Analysis</a></li><li><a class="tocitem" href="../api_docs/">API Documentation</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/supply_chain/">Supply Chain Optimization</a></li><li><a class="tocitem" href="../../tutorials/quadcopter/">Optimal Control of a Quadcopter</a></li><li><a class="tocitem" href="../../tutorials/gas_pipeline/">Optimal Control of a Natural Gas Network</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quickstart</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quickstart</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/plasmo-dev/Plasmo.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/plasmo-dev/Plasmo.jl/blob/main/docs/src/documentation/quickstart.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quickstart"><a class="docs-heading-anchor" href="#Quickstart">Quickstart</a><a id="Quickstart-1"></a><a class="docs-heading-anchor-permalink" href="#Quickstart" title="Permalink"></a></h1><p>This quickstart gives a brief overview of the functions needed to effectively use Plasmo.jl to build optimization models. If you have used <a href="https://github.com/jump-dev/JuMP.jl">JuMP.jl</a>, much of the functionality here will look familiar. In fact, the primary modeling objects in Plasmo.jl extend the <code>JuMP.AbstractModel</code> and support most JuMP methods.  </p><p>The below example demonstrates the construction of a simple linear optimization problem that contains two optinodes coupled by a simple linking contraint (which induces an <a href="../api_docs/#Plasmo.OptiEdge"><code>OptiEdge</code></a>) that is solved with the <a href="https://github.com/jump-dev/HiGHS.jl">HiGHS</a> linear optimization solver.</p><p>Once Plasmo.jl has been installed, you can use it from a Julia session as following:</p><pre><code class="language-julia-repl hljs">julia&gt; using Plasmo</code></pre><p>For this example we also need to import the HiGHS optimization solver and the <a href="https://github.com/plasmo-dev/PlasmoPlots.jl">PlasmoPlots</a> package which we use to visualize the graph structure.</p><pre><code class="language-julia-repl hljs">julia&gt; using HiGHS</code></pre><h2 id="Create-an-OptiGraph"><a class="docs-heading-anchor" href="#Create-an-OptiGraph">Create an OptiGraph</a><a id="Create-an-OptiGraph-1"></a><a class="docs-heading-anchor-permalink" href="#Create-an-OptiGraph" title="Permalink"></a></h2><p>The following command will create the optigraph (referred to as <code>graph</code>). We also see the printed output which denotes the number of optinodes, optiedges, subgraphs, variables, and constraints in the graph.</p><pre><code class="language-julia-repl hljs">julia&gt; graph = OptiGraph(;name=:quickstart_graph)
An OptiGraph
quickstart_graph #local elements  #total elements
--------------------------------------------------
          Nodes:         0                0
          Edges:         0                0
      Subgraphs:         0                0
      Variables:         0                0
    Constraints:         0                0
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>An <a href="../api_docs/#Plasmo.OptiGraph"><code>OptiGraph</code></a> distinguishes between its local elements (optinodes and optiedges contained directly within the graph) and its total elements (local elements plus elements contained within subgraphs). This distinction helps to describe nested graph structures as described in <a href="../modeling/#Modeling-with-OptiGraphs">Modeling with OptiGraphs</a>.</p></div></div><h2 id="Add-Variables-and-Constraints-(using-OptiNodes)"><a class="docs-heading-anchor" href="#Add-Variables-and-Constraints-(using-OptiNodes)">Add Variables and Constraints (using OptiNodes)</a><a id="Add-Variables-and-Constraints-(using-OptiNodes)-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Variables-and-Constraints-(using-OptiNodes)" title="Permalink"></a></h2><p>An optigraph consists of <a href="../api_docs/#Plasmo.OptiNode"><code>OptiNode</code></a> objects which represent stand-alone optimization models. An optinode supports JuMP macros used to create variables, constraints, expressions, and objective functions (i.e. it supports JuMP macros such as <code>@variable</code>, <code>@constraint</code>, <code>@expression</code> and <code>@objective</code>). The simplest way to add optinodes to an optigraph is to use the <a href="../api_docs/#Plasmo.@optinode"><code>@optinode</code></a> macro as shown in the following code snippet. Here we create the optinode <code>n1</code> and add two variables <code>x</code> and <code>y</code>. We also add a single constraint and an objective function to the node. By default, the name of a node is pre-pended with the name of the graph it was created in.</p><pre><code class="language-julia-repl hljs">julia&gt; @optinode(graph, n1)
n1

julia&gt; @variable(n1, y &gt;= 2)
n1[:y]

julia&gt; @variable(n1, x &gt;= 1)
n1[:x]

julia&gt; @constraint(n1, x + y &gt;= 3)
n1[:y] + n1[:x] ≥ 3

julia&gt; @objective(n1, Min, y)
n1[:y]

julia&gt; graph
An OptiGraph
quickstart_graph #local elements  #total elements
--------------------------------------------------
          Nodes:         1                1
          Edges:         0                0
      Subgraphs:         0                0
      Variables:         2                2
    Constraints:         3                3
</code></pre><p>We can create more optinodes and add variables, constraints, and objective functions to each of them.</p><pre><code class="language-julia hljs">@optinode(graph, n2);
@variable(n2, y &gt;= 0);
@variable(n2, x &gt;= 2);
@constraint(n2, x + y &gt;= 3);
@objective(n2, Min, y);

@optinode(graph, n3);
@variable(n3, y &gt;= 0);
@variable(n3, x &gt;= 0);
@constraint(n3, x + y &gt;= 3);
@objective(n3, Min, y);

println(graph)

# output

An OptiGraph
quickstart_graph #local elements  #total elements
--------------------------------------------------
          Nodes:         3                3
          Edges:         0                0
      Subgraphs:         0                0
      Variables:         6                6
    Constraints:         9                9
</code></pre><h2 id="Add-Linking-Constraints-(using-Edges)"><a class="docs-heading-anchor" href="#Add-Linking-Constraints-(using-Edges)">Add Linking Constraints (using Edges)</a><a id="Add-Linking-Constraints-(using-Edges)-1"></a><a class="docs-heading-anchor-permalink" href="#Add-Linking-Constraints-(using-Edges)" title="Permalink"></a></h2><p>A linking constraint can be created by adding a constraint to an <a href="../api_docs/#Plasmo.OptiEdge"><code>OptiEdge</code></a>. Linking constraints  couple variables across nodes (or graphs!) and can take any valid JuMP expression composed of node variables. We add a simple linear equality constraint here between variables that exist on nodes <code>n1</code>, <code>n2</code>, and <code>n3</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; edge = add_edge(graph, n1, n2, n3);

julia&gt; @constraint(edge, n1[:x] + n2[:x] + n3[:x] == 3)
n1[:x] + n2[:x] + n3[:x] = 3

julia&gt; println(graph)
An OptiGraph
quickstart_graph #local elements  #total elements
--------------------------------------------------
          Nodes:         3                3
          Edges:         1                1
      Subgraphs:         0                0
      Variables:         6                6
    Constraints:        10               10
</code></pre><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>You can also create edges implicitly using the <a href="../api_docs/#Plasmo.@linkconstraint"><code>@linkconstraint</code></a> macro which takes the exact same input as the <code>JuMP.@constraint</code> macro above.  The above snippet would correspond to doing:</p><pre><code class="language-julia hljs">@linkconstraint(graph, n1[:x] + n2[:x] + n3[:x] == 3)</code></pre><p>This would create a new edge between nodes <code>n1</code>, <code>n2</code>, and <code>n3</code> (if one does not exist) and add the constraint to it. You can also use the <code>JuMP.@constraint</code> macro directly on an optigraph to generate linking constraints, but the syntax displayed here is preferred to help code readability.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Plasmo.jl no longer supports the legacy nonlinear interface from JuMP.jl. Consequently, <code>@NLconstraint</code>, <code>@NLobjective</code>, and <code>@NLexpression</code> will no longer work. If you have code that  uses these macros, you will need to update to the current interface using <code>@constraint</code>, <code>@objective</code>, and <code>@expression</code>.</p></div></div><h2 id="Solve-the-OptiGraph-and-Query-the-Solution"><a class="docs-heading-anchor" href="#Solve-the-OptiGraph-and-Query-the-Solution">Solve the OptiGraph and Query the Solution</a><a id="Solve-the-OptiGraph-and-Query-the-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-the-OptiGraph-and-Query-the-Solution" title="Permalink"></a></h2><p>We can set the objective function of an optigraph using either the node objectives or by defining an objective directly using the <code>JuMP.@objective</code> macro on the graph. Since we already defined an  objective for each node we can use the <code>set_to_node_objectives</code> function to denote the graph objective.</p><pre><code class="language-julia-repl hljs">julia&gt; set_to_node_objectives(graph)

julia&gt; objective_function(graph)
n1[:y] + n2[:y] + n3[:y]</code></pre><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>The graph objective approach would look like:</p><pre><code class="language-julia hljs">@objective(graph, Min, n1[:y] + n2[:y] + n3[:y])</code></pre></div></div><p>Plasmo.jl uses <a href="https://github.com/jump-dev/MathOptInterface.jl">MathOptInterface.jl</a> internally to interface with optimization solvers.  We can optimize an optigraph using the <a href="../api_docs/#JuMP.set_optimizer"><code>set_optimizer</code></a> and <a href="../api_docs/#JuMP.optimize!"><code>optimize!</code></a> functions just like in JuMP.jl. Here we also set the HiGHS attribute <code>log_to_console</code> to false to  suppress the output.</p><pre><code class="language-julia-repl hljs">julia&gt; set_optimizer(graph, HiGHS.Optimizer);

julia&gt; set_optimizer_attribute(graph, MOI.RawOptimizerAttribute(&quot;log_to_console&quot;), false)

julia&gt; optimize!(graph)
</code></pre><p>After returning from the optimizer we can query the termination status using <a href="../api_docs/#JuMP.termination_status"><code>termination_status</code></a>. We can also query the solution of variables using <a href="../api_docs/#JuMP.value"><code>value</code></a> and the objective value of the graph using <a href="../api_docs/#JuMP.objective_value"><code>objective_value</code></a></p><pre><code class="language-julia-repl hljs">julia&gt; termination_status(graph)   
OPTIMAL::TerminationStatusCode = 1

julia&gt; value(graph, n1[:x])    
1.0

julia&gt; value(graph, n2[:x])
2.0

julia&gt; value(graph, n3[:x])
0.0

julia&gt; objective_value(graph)
6.0
</code></pre><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>It is possible to optimize individual optinodes or different optigraphs that contain the same optinode (nodes can be used in multiple optigraphs). Graph-specific solutions can be accessed using <code>value(node, variable)</code> (if optimizing a single node) or <code>value(graph, variable)</code> (if optimizing an optigraph). \
Note that optimizing a node creates a new graph internally; <em>the optimizer interface always goes through a graph</em>. It is also possible to use <code>value(variable)</code> without specifying a graph, but this will always return the value corresponding to the graph that created the node (this graph can be queried using <code>source_graph(node)</code>). Using <code>value(node</code>) is likely fine for most use-cases, but be aware that you should use the <code>value(graph, variable)</code> method when dealing with multiple graphs to avoid grabbing a wrong solution.</p></div></div><h2 id="Visualize-the-Structure"><a class="docs-heading-anchor" href="#Visualize-the-Structure">Visualize the Structure</a><a id="Visualize-the-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Visualize-the-Structure" title="Permalink"></a></h2><p>Lastly, it is often useful to visualize the structure of an optigraph. The visualization can lead to insights about an optimization problem and understand its connectivity. Plasmo.jl uses <a href="https://github.com/plasmo-dev/PlasmoPlots.jl">PlasmoPlots.jl</a> (which builds on <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> and <a href="https://github.com/JuliaGraphs/NetworkLayout.jl">NetworkLayout.jl</a>) to visualize the layout of an optigraph. The code here shows how to obtain the graph topology using <a href><code>PlasmoPlots.layout_plot</code></a> and we plot the corresponding incidence matrix structure using <a href><code>PlasmoPlots.matrix_plot</code></a>. Both of these functions can accept keyword arguments to customize their layout or appearance. The matrix visualization also encodes information on the number of variables and constraints in each optinode and optiedge. The left figure shows a standard graph visualization where we draw an edge between each pair of nodes if they share an edge, and the right figure shows the matrix representation where labeled blocks correspond to nodes and blue marks represent linking constraints that connect their variables. The node layout helps visualize the overall connectivity of the graph while the matrix layout helps visualize the size of nodes and edges.</p><pre><code class="language-julia hljs">plt_graph = PlasmoPlots.layout_plot(
                graph,
                node_labels=true, 
                markersize=30, 
                labelsize=15, 
                linewidth=4,
                layout_options=Dict(
                    :tol=&gt;0.01, 
                    :iterations=&gt;2
                ),
                plt_options=Dict(
                    :legend=&gt;false, 
                    :framestyle=&gt;:box, 
                    :grid=&gt;false,
                    :size=&gt;(400,400), 
                    :axis=&gt;nothing)
                )

plt_matrix = PlasmoPlots.matrix_plot(graph, node_labels=true, markersize=15)   </code></pre><p><img src="../../assets/graph_layout.svg" alt="graph_quickstart"/> <img src="../../assets/matrix_layout.svg" alt="matrix_quickstart"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Introduction</a><a class="docs-footer-nextpage" href="../modeling/">Modeling with OptiGraphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Saturday 2 November 2024 05:23">Saturday 2 November 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
